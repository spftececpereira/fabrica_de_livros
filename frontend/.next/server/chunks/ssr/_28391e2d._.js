module.exports=[3103,a=>{"use strict";var b,c,d=((b={}).DRAFT="draft",b.PROCESSING="processing",b.COMPLETED="completed",b.FAILED="failed",b),e=((c={}).CARTOON="cartoon",c.REALISTIC="realistic",c.MANGA="manga",c.CLASSIC="classic",c);let f={MIN_PAGES:5,MAX_PAGES:20,MIN_TITLE_LENGTH:3,MAX_TITLE_LENGTH:200,MAX_DESCRIPTION_LENGTH:1e3,VALID_STYLES:Object.values(e),VALID_STATUSES:Object.values(d)};a.s(["BOOK_CONSTRAINTS",0,f,"BookStatus",()=>d,"BookStyle",()=>e,"bookHelpers",0,{isEditable:a=>["draft","failed"].includes(a.status),isProcessing:a=>"processing"===a.status,isCompleted:a=>"completed"===a.status,canGeneratePdf:a=>"completed"===a.status&&a.pages.length===a.pages_count,getStyleLabel:a=>({cartoon:"Cartoon",realistic:"Realista",manga:"MangÃ¡",classic:"ClÃ¡ssico"})[a]||a,getStatusLabel:a=>({draft:"Rascunho",processing:"Processando",completed:"ConcluÃ­do",failed:"Falhou"})[a]||a,getStatusColor:a=>{let b={draft:"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-300",processing:"bg-yellow-100 text-yellow-800 dark:bg-yellow-800 dark:text-yellow-300",completed:"bg-green-100 text-green-800 dark:bg-green-800 dark:text-green-300",failed:"bg-red-100 text-red-800 dark:bg-red-800 dark:text-red-300"};return b[a]||b.draft}}])},2150,a=>{"use strict";var b=a.i(73232),c=a.i(25831),d=a.i(43122),e=a.i(51792),f="Progress",[g,h]=(0,d.createContextScope)(f),[i,j]=g(f),k=c.forwardRef((a,c)=>{var d,f;let{__scopeProgress:g,value:h=null,max:j,getValueLabel:k=n,...l}=a;(j||0===j)&&!q(j)&&console.error((d=`${j}`,`Invalid prop \`max\` of value \`${d}\` supplied to \`Progress\`. Only numbers greater than 0 are valid max values. Defaulting to \`100\`.`));let m=q(j)?j:100;null===h||r(h,m)||console.error((f=`${h}`,`Invalid prop \`value\` of value \`${f}\` supplied to \`Progress\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or 100 if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`));let s=r(h,m)?h:null,t=p(s)?k(s,m):void 0;return(0,b.jsx)(i,{scope:g,value:s,max:m,children:(0,b.jsx)(e.Primitive.div,{"aria-valuemax":m,"aria-valuemin":0,"aria-valuenow":p(s)?s:void 0,"aria-valuetext":t,role:"progressbar","data-state":o(s,m),"data-value":s??void 0,"data-max":m,...l,ref:c})})});k.displayName=f;var l="ProgressIndicator",m=c.forwardRef((a,c)=>{let{__scopeProgress:d,...f}=a,g=j(l,d);return(0,b.jsx)(e.Primitive.div,{"data-state":o(g.value,g.max),"data-value":g.value??void 0,"data-max":g.max,...f,ref:c})});function n(a,b){return`${Math.round(a/b*100)}%`}function o(a,b){return null==a?"indeterminate":a===b?"complete":"loading"}function p(a){return"number"==typeof a}function q(a){return p(a)&&!isNaN(a)&&a>0}function r(a,b){return p(a)&&!isNaN(a)&&a<=b&&a>=0}m.displayName=l;var s=a.i(97895);let t=c.forwardRef(({className:a,value:c,...d},e)=>(0,b.jsx)(k,{ref:e,className:(0,s.cn)("relative h-2 w-full overflow-hidden rounded-full bg-primary/20",a),...d,children:(0,b.jsx)(m,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(c||0)}%)`}})}));t.displayName=k.displayName,a.s(["Progress",()=>t],2150)},63652,(a,b,c)=>{"use strict";c._=function(a){return a&&a.__esModule?a:{default:a}}},83308,a=>{"use strict";var b=a.i(13728),c=a.i(40278),d=a.i(554),e=a.i(19691),f=class extends d.QueryObserver{constructor(a,b){super(a,b)}bindMethods(){super.bindMethods(),this.fetchNextPage=this.fetchNextPage.bind(this),this.fetchPreviousPage=this.fetchPreviousPage.bind(this)}setOptions(a){super.setOptions({...a,behavior:(0,e.infiniteQueryBehavior)()})}getOptimisticResult(a){return a.behavior=(0,e.infiniteQueryBehavior)(),super.getOptimisticResult(a)}fetchNextPage(a){return this.fetch({...a,meta:{fetchMore:{direction:"forward"}}})}fetchPreviousPage(a){return this.fetch({...a,meta:{fetchMore:{direction:"backward"}}})}createResult(a,b){let{state:c}=a,d=super.createResult(a,b),{isFetching:f,isRefetching:g,isError:h,isRefetchError:i}=d,j=c.fetchMeta?.fetchMore?.direction,k=h&&"forward"===j,l=f&&"forward"===j,m=h&&"backward"===j,n=f&&"backward"===j;return{...d,fetchNextPage:this.fetchNextPage,fetchPreviousPage:this.fetchPreviousPage,hasNextPage:(0,e.hasNextPage)(b,c.data),hasPreviousPage:(0,e.hasPreviousPage)(b,c.data),isFetchNextPageError:k,isFetchingNextPage:l,isFetchPreviousPageError:m,isFetchingPreviousPage:n,isRefetchError:i&&!k&&!m,isRefetching:g&&!l&&!n}}},g=a.i(57222),h=a.i(56916),i=a.i(53250),j=a.i(90511),k=a.i(4956),l=a.i(3103);let m=(0,k.create)((a,b)=>({selectedBook:null,recentBooks:[],bookCache:{},generatingBooks:new Set,generationProgress:{},setSelectedBook:c=>{a({selectedBook:c}),c&&!b().bookCache[c.id]&&b().addToCache(c)},addToCache:b=>{a(a=>({bookCache:{...a.bookCache,[b.id]:b}}))},removeFromCache:b=>{a(a=>{let c={...a.bookCache};return delete c[b],{bookCache:c,selectedBook:a.selectedBook?.id===b?null:a.selectedBook,recentBooks:a.recentBooks.filter(a=>a.id!==b)}})},updateBookInCache:(b,c)=>{a(a=>{let d=a.bookCache[b];if(!d)return a;let e={...d,...c};return{bookCache:{...a.bookCache,[b]:e},selectedBook:a.selectedBook?.id===b?e:a.selectedBook,recentBooks:a.recentBooks.map(a=>a.id===b?e:a)}})},setRecentBooks:c=>{a({recentBooks:c}),c.forEach(a=>{b().addToCache(a)})},startGeneration:(c,d)=>{a(a=>({generatingBooks:new Set([...a.generatingBooks,c]),generationProgress:{...a.generationProgress,[c]:{taskId:d,progress:0,status:"pending",message:"Iniciando geraÃ§Ã£o..."}}})),b().updateBookInCache(c,{status:l.BookStatus.PROCESSING})},updateGeneration:(b,c,d,e)=>{a(a=>{let f=a.generationProgress[b];return f?{generationProgress:{...a.generationProgress,[b]:{...f,progress:c,status:d,message:e}}}:a})},completeGeneration:(c,d)=>{a(a=>{let b=new Set(a.generatingBooks);b.delete(c);let d={...a.generationProgress};return delete d[c],{generatingBooks:b,generationProgress:d}}),d?b().addToCache(d):b().updateBookInCache(c,{status:l.BookStatus.COMPLETED})},clearGeneration:c=>{a(a=>{let b=new Set(a.generatingBooks);b.delete(c);let d={...a.generationProgress};return delete d[c],{generatingBooks:b,generationProgress:d}}),b().updateBookInCache(c,{status:l.BookStatus.FAILED})}})),n=()=>{let a=m();return{...a,isGenerating:b=>a.generatingBooks.has(b),getGenerationProgress:b=>a.generationProgress[b]||null,getCachedBook:b=>a.bookCache[b]||null,getBooksByStatus:b=>a.recentBooks.filter(a=>a.status===b),getCompletedBooks:()=>a.recentBooks.filter(a=>a.status===l.BookStatus.COMPLETED),getDraftBooks:()=>a.recentBooks.filter(a=>a.status===l.BookStatus.DRAFT),getProcessingBooks:()=>a.recentBooks.filter(a=>a.status===l.BookStatus.PROCESSING)}};a.s(["useBook",0,a=>{let{addToCache:c,getCachedBook:d}=n();return(0,b.useQuery)({queryKey:j.queryKeys.books.detail(a),queryFn:async()=>{let b=await i.api.get(`/api/v1/books/${a}`);return c(b),b},enabled:!!a,staleTime:3e5,initialData:()=>d(a)||void 0})},"useBooks",0,a=>{var b;return b={queryKey:j.queryKeys.books.list(a),queryFn:async({pageParam:b=0})=>{let c=new URLSearchParams({skip:b.toString(),limit:(a?.limit||20).toString(),...a?.status_filter&&{status_filter:a.status_filter},...a?.style_filter&&{style_filter:a.style_filter},...a?.search&&{search:a.search},...a?.sort_by&&{sort_by:a.sort_by},...a?.sort_order&&{sort_order:a.sort_order}});return i.api.get(`/api/v1/books?${c.toString()}`)},initialPageParam:0,getNextPageParam:a=>{if(a.has_next)return a.skip+a.limit},staleTime:12e4},(0,g.useBaseQuery)(b,f,void 0)},"useCreateBook",0,()=>{let{addToCache:a}=n();return(0,c.useMutation)({mutationFn:async a=>i.api.post("/api/v1/books",a),onSuccess:b=>{a(b),j.invalidateQueries.books.lists(),j.invalidateQueries.books.stats(),h.toast.success("Livro criado com sucesso!")},onError:a=>{h.toast.error(a.message||"Erro ao criar livro")}})},"useDownloadPDF",0,()=>(0,c.useMutation)({mutationFn:async({bookId:a,filename:b})=>(0,i.downloadFile)(`/api/v1/books/${a}/pdf`,b),onSuccess:()=>{h.toast.success("Download iniciado!")},onError:a=>{h.toast.error(a.message||"Erro ao baixar PDF")}}),"useStartBookGeneration",0,()=>{let{startGeneration:a}=n();return(0,c.useMutation)({mutationFn:async a=>i.api.post(`/api/v1/books/${a}/generate`),onSuccess:(b,c)=>{a(c,b.task_id),h.toast.success("GeraÃ§Ã£o do livro iniciada!")},onError:a=>{h.toast.error(a.message||"Erro ao iniciar geraÃ§Ã£o do livro")}})}],83308)},26717,a=>{"use strict";let b=(0,a.i(61313).default)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);a.s(["ArrowLeft",()=>b],26717)},20813,a=>{"use strict";var b=a.i(73232),c=a.i(45459),d=a.i(50917),e=a.i(25831),f=a.i(61313);let g=(0,f.default)("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);var h=a.i(70500),h=h;let i=(0,f.default)("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]]);var j=a.i(26717);let k=(0,f.default)("maximize",[["path",{d:"M8 3H5a2 2 0 0 0-2 2v3",key:"1dcmit"}],["path",{d:"M21 8V5a2 2 0 0 0-2-2h-3",key:"1e4gt3"}],["path",{d:"M3 16v3a2 2 0 0 0 2 2h3",key:"wsl5sc"}],["path",{d:"M16 21h3a2 2 0 0 0 2-2v-3",key:"18trek"}]]),l=(0,f.default)("minimize",[["path",{d:"M8 3v3a2 2 0 0 1-2 2H3",key:"hohbtr"}],["path",{d:"M21 8h-3a2 2 0 0 1-2-2V3",key:"5jw1f3"}],["path",{d:"M3 16h3a2 2 0 0 1 2 2v3",key:"198tvr"}],["path",{d:"M16 21v-3a2 2 0 0 1 2-2h3",key:"ph8mxp"}]]);var m=a.i(61821),n=a.i(40695),o=a.i(3130),p=a.i(2150),q=a.i(54161),r=a.i(83308);function s({book:a,onClose:c}){let[d,f]=(0,e.useState)(0),[s,t]=(0,e.useState)(!1),u=(0,r.useDownloadPDF)(),v=a.pages.sort((a,b)=>a.page_number-b.page_number),w=v.length,x=w>0?(d+1)/w*100:0;(0,e.useEffect)(()=>{},[d,w,s,c]);let y=async()=>{try{await u.mutateAsync({bookId:a.id,filename:`${a.title.replace(/[^a-zA-Z0-9]/g,"_")}.pdf`})}catch(a){}},z=()=>{d<w-1&&f(a=>a+1)},A=()=>{d>0&&f(a=>a-1)};if(0===w)return(0,b.jsx)("div",{className:"flex items-center justify-center h-96",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:"text-6xl mb-4",children:"ðŸ“–"}),(0,b.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Livro sem pÃ¡ginas"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Este livro ainda nÃ£o possui pÃ¡ginas geradas."})]})});let B=v[d];return(0,b.jsxs)("div",{className:`${s?"fixed inset-0 z-50 bg-background":""}`,children:[(0,b.jsxs)("div",{className:"flex items-center justify-between p-4 border-b",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[c&&(0,b.jsxs)(n.Button,{variant:"ghost",size:"sm",onClick:c,children:[(0,b.jsx)(j.ArrowLeft,{className:"h-4 w-4 mr-2"}),"Voltar"]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-xl font-bold",children:a.title}),(0,b.jsxs)("p",{className:"text-sm text-muted-foreground",children:["PÃ¡gina ",d+1," de ",w]})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(n.Button,{variant:"outline",size:"sm",onClick:()=>t(!s),children:s?(0,b.jsx)(l,{className:"h-4 w-4"}):(0,b.jsx)(k,{className:"h-4 w-4"})}),(0,b.jsxs)(n.Button,{variant:"outline",size:"sm",onClick:y,disabled:u.isPending,children:[(0,b.jsx)(i,{className:"h-4 w-4 mr-2"}),u.isPending?"Baixando...":"PDF"]})]})]}),(0,b.jsx)("div",{className:"px-4 py-2",children:(0,b.jsx)(p.Progress,{value:x,className:"w-full"})}),(0,b.jsxs)("div",{className:"flex-1 flex",children:[(0,b.jsx)("div",{className:"w-16 flex items-center justify-center",children:(0,b.jsx)(n.Button,{variant:"ghost",size:"lg",onClick:A,disabled:0===d,className:"h-20 w-12",children:(0,b.jsx)(g,{className:"h-8 w-8"})})}),(0,b.jsx)("div",{className:"flex-1 max-w-4xl mx-auto p-4",children:(0,b.jsx)(o.Card,{className:"h-full",children:(0,b.jsx)(o.CardContent,{className:"p-0 h-full",children:(0,b.jsxs)("div",{className:"grid md:grid-cols-2 h-full",children:[(0,b.jsxs)("div",{className:"relative bg-muted rounded-l-lg overflow-hidden",children:[B.image_url?(0,b.jsx)(m.default,{src:B.image_url,alt:`P\xe1gina ${B.page_number}`,fill:!0,className:"object-cover",priority:!0}):(0,b.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,b.jsxs)("div",{className:"text-center text-muted-foreground",children:[(0,b.jsx)("div",{className:"text-4xl mb-4",children:"ðŸŽ¨"}),(0,b.jsx)("p",{children:"Imagem sendo gerada..."}),B.image_prompt&&(0,b.jsxs)("p",{className:"text-xs mt-2 max-w-xs",children:["Prompt: ",B.image_prompt]})]})}),(0,b.jsx)("div",{className:"absolute top-4 left-4",children:(0,b.jsxs)(q.Badge,{variant:"secondary",children:["PÃ¡gina ",B.page_number]})})]}),(0,b.jsx)("div",{className:"p-8 flex flex-col justify-center",children:B.text_content?(0,b.jsx)("div",{className:"prose prose-lg dark:prose-invert max-w-none",children:(0,b.jsx)("p",{className:"text-lg leading-relaxed whitespace-pre-wrap",children:B.text_content})}):(0,b.jsxs)("div",{className:"text-center text-muted-foreground",children:[(0,b.jsx)("div",{className:"text-4xl mb-4",children:"âœï¸"}),(0,b.jsx)("p",{children:"Texto sendo gerado..."})]})})]})})})}),(0,b.jsx)("div",{className:"w-16 flex items-center justify-center",children:(0,b.jsx)(n.Button,{variant:"ghost",size:"lg",onClick:z,disabled:d===w-1,className:"h-20 w-12",children:(0,b.jsx)(h.default,{className:"h-8 w-8"})})})]}),(0,b.jsxs)("div",{className:"flex items-center justify-center gap-2 p-4 border-t",children:[(0,b.jsxs)(n.Button,{variant:"outline",size:"sm",onClick:A,disabled:0===d,children:[(0,b.jsx)(g,{className:"h-4 w-4 mr-2"}),"Anterior"]}),(0,b.jsx)("div",{className:"flex gap-1",children:v.map((a,c)=>(0,b.jsx)(n.Button,{variant:c===d?"default":"outline",size:"sm",onClick:()=>f(c),className:"w-8 h-8 p-0",children:c+1},c))}),(0,b.jsxs)(n.Button,{variant:"outline",size:"sm",onClick:z,disabled:d===w-1,children:["PrÃ³xima",(0,b.jsx)(h.default,{className:"h-4 w-4 ml-2"})]})]}),(0,b.jsxs)("div",{className:"text-xs text-muted-foreground text-center pb-2",children:["Use as setas â† â†’ para navegar â€¢ ESC para ",s?"sair do tela cheia":"fechar"]})]})}function t(){let a=(0,c.useParams)(),e=(0,c.useRouter)(),f=parseInt(a.id),{data:g,isLoading:h,error:i}=(0,r.useBook)(f);return h?(0,b.jsx)("div",{className:"flex items-center justify-center h-96",children:(0,b.jsxs)("div",{className:"flex items-center gap-2 text-muted-foreground",children:[(0,b.jsx)(d.Loader2,{className:"h-6 w-6 animate-spin"}),(0,b.jsx)("span",{children:"Carregando livro..."})]})}):i?(0,b.jsx)("div",{className:"flex items-center justify-center h-96",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:"text-6xl mb-4",children:"ðŸ˜ž"}),(0,b.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Erro ao carregar livro"}),(0,b.jsx)("p",{className:"text-muted-foreground mb-4",children:i.message||"NÃ£o foi possÃ­vel carregar o livro."}),(0,b.jsx)("button",{onClick:()=>e.back(),className:"text-primary hover:underline",children:"Voltar"})]})}):g?(0,b.jsx)("div",{className:"min-h-screen -m-6",children:(0,b.jsx)(s,{book:g,onClose:()=>e.back()})}):(0,b.jsx)("div",{className:"flex items-center justify-center h-96",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:"text-6xl mb-4",children:"ðŸ“–"}),(0,b.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Livro nÃ£o encontrado"}),(0,b.jsx)("p",{className:"text-muted-foreground mb-4",children:"O livro que vocÃª estÃ¡ procurando nÃ£o existe ou foi removido."}),(0,b.jsx)("button",{onClick:()=>e.push("/dashboard"),className:"text-primary hover:underline",children:"Ir para Dashboard"})]})})}a.s(["default",()=>t],20813)}];

//# sourceMappingURL=_28391e2d._.js.map